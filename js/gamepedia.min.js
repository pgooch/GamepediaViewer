function updatePlatformSelect(){if("undefined"!=typeof localStorage.platforms){var e=JSON.parse(localStorage.platforms);$.each(e,function(e,t){$('select[name="platform"]').append('<option value="'+t+'">'+t+"</option>")})}else $('input[name="startImport"]').click()}function loadImage(e){navigator.onLine?$("#image-loader").attr("src",e):$("#details .ZIMAGE .value").html('<div class="image_loading">Current in Off-line mode</div>')}function updateDisplayedDate(){if("string"==typeof localStorage.lastUpdate){var e=new Date(parseInt(localStorage.lastUpdate));$("#footer p.update-notice").html("Database Pulled<br/> "+e+".")}else $("#footer p.update-notice").html("There has been no database pulled.")}function searchStressTest(e){var t=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],o=0;for(i=0;e>i;i++)setTimeout(function(){o++;var e=Math.round(25*Math.random());console.log("Search #"+o+" : "+t[e]),$('[name="search"]').val(t[e]).trigger("keyup")},200*(i+1))}function importStressTest(e){var t=0;for(i=0;e>i;i++)setTimeout(function(){t++,console.log("Import #"+t),$('[name="startImport"]').trigger("click")},500*(i+1))}function viewStressTest(e){var t=0;for(i=0;e>i;i++)setTimeout(function(){t++;var e=$("li");e=e[Math.round(Math.random()*e.length)],console.log("View #"+t,e),window.location.hash=$(e).find("a").attr("href")},100*(i+1))}$("body").on("click",'input[name="startImport"]',function(){if($("#working-notice .message").html("Starting Importer..."),$("#working-notice").animate({height:"3em"},500,function(){$(this).css("height","auto")}),navigator.onLine)var e=new Worker("./js/gamepedia.importer.min.js");else $("#working-notice .message").html("Currently in Off-line Mode"),setTimeout(function(){$("#working-notice").animate({height:"0px"},500)},3e3);e.onmessage=function(t){"done"==t.data?(setTimeout(function(){$("#working-notice").animate({height:"0px"},500),e.terminate()},750),localStorage.lastUpdate=t.timeStamp,updateDisplayedDate(),updatePlatformSelect(),$("form").trigger("submit")):"string"==typeof t.data.message?$("#working-notice .message").html(t.data.message):"object"==typeof t.data.localStore?$.each(t.data.localStore,function(e,t){localStorage[e]=JSON.stringify(t)}):(console.log("I got something else back from the worker..."),console.log("string"==typeof t.data.json?JSON.parse(JSON.parse(t.data.json).srcElement.response):t))},e.onerror=function(e){$("#working-notice .message").html("Unable to load database."),console.log(e),setTimeout(function(){$("#working-notice").animate({height:"0px"},500)},3e3)}}),localStorage.lastUpdate<=(new Date).getTime()-1e3*_timeTillAutoUpate&&$('input[name="startImport"]').click(),$("body").on("click",'input[name="deleteDatabase"]',function(){confirm("Are you sure you want to delete your cached gamepedia database?\n\nThis will not change any content in your dropbox, but you will be required to re-load all the data before it will be viewable again.")&&(indexedDB.deleteDatabase("gamepedia"),localStorage.clear())}),updatePlatformSelect(),$("body").on("keyup",'form input[name="search"]',function(e){$(this).closest("form").trigger("submit")}),$("body").on("change","form select",function(e){$(this).closest("form").trigger("submit")}),$("body").on("blur",'form input[name="search"]',function(e){$(this).closest("form").trigger("submit")}),$(document).ready(function(){var e=localStorage.filterSettings;"undefined"!=typeof e&&(e=JSON.parse(e),$.each(e,function(e,t){$('form input[name="'+e+'"]').val(t),$('form select[name="'+e+'"] option[value="'+t+'"]').attr("selected",!0)}),$("form").trigger("submit"))});var resultsTitleOffset=-1;$(window).on("scroll",function(e){0>resultsTitleOffset&&(resultsTitleOffset=$("h2:not(.locked)").offset().top),resultsTitleOffset<=$(window).scrollTop()?$("h2.locked").show():$("h2.locked").hide()}),$("body").on("click","h2.locked a",function(){$(window).scrollTop(0)}),$("body").on("submit","form",function(e){e.preventDefault();var t=localStorage.filterSettings;t="undefined"==typeof t?{platform:"",entry_type:"A",search:""}:JSON.parse(t),$('form input:not([type="submit"]), select').each(function(){t[$(this).attr("name")]=$(this).val()}),t=JSON.stringify(t),localStorage.filterSettings=t;var o=new Worker("./js/gamepedia.searcher.min.js");o.postMessage(t),o.onmessage=function(e){var t=e.data;$("#results").attr("data-timestamp")<e.timeStamp&&($("#results").attr("data-timestamp",e.timeStamp),$("#results").html(e.data),o.terminate())}}),window.onhashchange=function(){if("#"==window.location.hash.substr(0,1)){$("body").attr("data-scrollPos",$(window).scrollTop()),$("#details").html('<div class="loading">Loading Details...</div>'),$("body").addClass("details-open");var e=window.location.hash.substr(1).split("-")[0];view=new Worker("./js/gamepedia.view.min.js"),view.postMessage(e),view.onmessage=function(e){$("#details").html(e.data),view.terminate()}}else $("body").removeClass("details-open"),$(window).scrollTop($("body").attr("data-scrollPos"))},$(window).trigger("hashchange"),$("body").on("click",'input[name="closeDetails"]',function(){window.history.back()}),$("#image-loader").on("load",function(){$("#details .ZIMAGE .value").html('<img src="'+$(this).attr("src")+'" alt="Cover Image">')}),$("#image-loader").on("error",function(){$("#details .ZIMAGE .value").html('<div class="image_loading">Unable to load image.</div>')}),updateDisplayedDate(),$("body").on("change",'select[name="theme"]',function(){localStorage.theme=$(this).val(),"undefined"==typeof $("html").attr("themeChanged")&&($("html head").append("<style>*{transition: background-color 1s, border-bottom-color 1s, border-color 1s, border-left-color 1s, border-right-color 1s, border-top-color 1s, color;}</style>"),$("html").attr("themeChanged",!0)),$("html").attr("class",$(this).val())}),$("html").attr("class",localStorage.theme),$('select[name="theme"] option[value="'+localStorage.theme+'"]').attr("selected",!0);
//# sourceMappingURL=./gamepedia.min.map